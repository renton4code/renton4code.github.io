(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34c3e184"],{"1f3a":function(e,t,s){},"3d76":function(e,t,s){"use strict";s.r(t);var n,o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"store-closing"},[s("modal-wrapper",{attrs:{loading:e.loading,disabled:e.isAcceptDisabled,"data-qa":"accept-modal"},on:{accept:e.acceptFormChanges,cancel:e.closeStoreClosingModal}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoadingClosedStores,expression:"isLoadingClosedStores"}],staticClass:"store-closing_body",attrs:{slot:"body"},slot:"body"},[e.isClosed?s("div",{staticClass:"store-closing_section"},[s("h2",{staticClass:"store-closing_section_title"},[e._v(" "+e._s(e.$t("store.open"))+" ")]),1===e.availableStoreAddresses.length?s("section",[s("span",{staticClass:"store-closing_section_subtitle"},[e._v(" "+e._s(e.$t("store.opening.subtitle"))+" ")]),s("div",{staticClass:"store-closing_section_content"},[s("el-radio-group",{attrs:{size:"large"},model:{value:e.closedUntil,callback:function(t){e.closedUntil=t},expression:"closedUntil"}},[s("el-radio",{staticClass:"store-closing_section_item",attrs:{label:null,"data-qa":"open-store-button"}},[e._v(" "+e._s(e.$t("common.open"))+" ")])],1)],1)]):e.shouldShowStoreOpeningSelector?s("section",[s("h3",{staticClass:"store-closing_section_subtitle"},[e._v(" "+e._s(e.$t("store.opening.addresses"))+" ")]),s("store-address-selector",{attrs:{options:e.closedAddresses,disabled:e.selectedAddressesForClosing.length>0,"data-qa":"open-store-address-selector"},on:{"selection-change":e.updateSelectedIdsForOpening}})],1):e._e()]):e._e(),s("div",{staticClass:"store-closing_section"},[s("h2",{staticClass:"store-closing_section_title"},[e._v(" "+e._s(e.$t("store.close"))+" ")]),e.isMultiView?s("div",{staticClass:"store-closing_multi"},[s("h3",{staticClass:"store-closing_section_subtitle"},[e._v(" "+e._s(e.$t("store.closing.addresses"))+" ")]),s("store-address-selector",{attrs:{options:e.selectedStoreAddresses,disabled:e.hasAddressesSelectedForOpening,"data-qa":"close-store-address-selector"},on:{"selection-change":e.updateSelectedIdsForClosing}})],1):e._e(),[s("span",{staticClass:"store-closing_section_subtitle"},[e._v(" "+e._s(e.$t("store.closing.subtitle"))+" ")]),s("div",{staticClass:"store-closing_section_content"},[s("el-radio-group",{attrs:{disabled:e.hasAddressesSelectedForOpening,size:"large"},model:{value:e.closedUntil,callback:function(t){e.closedUntil=t},expression:"closedUntil"}},e._l(e.closingTimeOptions,(function(t){return s("el-radio",{key:t.value,staticClass:"close-option store-closing_section_item",attrs:{label:t.value,"data-qa":"closed-until-options"}},[e.displayCustomOption(t.value)?e._e():s("span",[e._v(e._s(t.displayText))]),e.displayCustomOption(t.value)?[s("el-date-picker",{attrs:{type:"date",placeholder:e.$t("from.label")+":",readonly:!0},model:{value:e.closedUntilCustom.start,callback:function(t){e.$set(e.closedUntilCustom,"start",t)},expression:"closedUntilCustom.start"}}),s("el-date-picker",{attrs:{type:"date",placeholder:e.$t("until.label")+":",readonly:!0},model:{value:e.closedUntilCustom.end,callback:function(t){e.$set(e.closedUntilCustom,"end",t)},expression:"closedUntilCustom.end"}}),s("v-date-picker",{attrs:{id:"closePicker","theme-styles":e.themeStyles,"select-attribute":e.selectedAttributes,"drag-attribute":e.dragAttributes,mode:"range","is-inline":!0,"min-date":e.today,placeholder:e.$t("time.options.date.picker.hint"),"data-qa":"date-picker"},on:{drag:e.updateStart,input:e.updateEnd},model:{value:e.calendarInterval,callback:function(t){e.calendarInterval=t},expression:"calendarInterval"}})]:e._e()],2)})),1),s("h3",{staticClass:"store-closing_section_subtitle"},[e._v(" "+e._s(e.$t("store.closing.reason.title"))+" ")]),s("el-radio-group",{attrs:{size:"large",disabled:e.hasAddressesSelectedForOpening},model:{value:e.closingReason,callback:function(t){e.closingReason=t},expression:"closingReason"}},e._l(e.filteredClosingReasons,(function(t){return s("el-radio",{key:t.value,staticClass:"store-closing_section_item",attrs:{label:t.value,"data-qa":"closing-reason-options"}},[e._v(" "+e._s(t.displayText)+" ")])})),1)],1)]],2)])]),s("store-closing-warning-modal",{attrs:{open:e.shouldShowWarningModal,"closed-store-ids":e.selectedAddressesForClosing,"data-qa":"store-closing-warning-modal"},on:{"force-close":e.handleForceCloseFromModal,cancel:e.handleCancelFromModal,dismiss:e.handleDismissFromModal}})],1)},i=[],r=(s("4de4"),s("caad"),s("d3b7"),s("25f0"),s("96cf"),s("1da1")),a=s("d4ec"),l=s("bee2"),c=s("262e"),d=s("2caf"),u=s("9ab4"),h=s("80a6"),g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("glovo-modal",{attrs:{value:e.open,"show-close-button":!0,"data-qa":"store-closing-warning-modal"},on:{close:e.dismiss}},[s("template",{slot:"content"},[s("div",{staticClass:"warning__modal"},[s("icon",{staticClass:"warning__modal__icon",attrs:{name:"warning"}}),s("h1",{staticClass:"warning__modal__title"},[e._v(e._s(e.pendingOrdersText))]),s("div",{staticClass:"warning__modal__subtitle"},[s("span",{staticClass:"warning__modal__subtitle--cancellation"},[e._v(e._s(e.orderCancellationText))]),s("span",[e._v(e._s(this.$t("store.close.warn.cancellation")))])])],1)]),s("template",{slot:"buttons"},[s("div",{staticClass:"warning__buttons"},[s("glovo-btn",{staticClass:"warning__buttons--confirm",attrs:{type:"white-green",text:this.$t("store.close.warn.confirm"),bold:!0,size:"large","data-qa":"confirm-button"},on:{clack:function(t){return t.stopPropagation(),t.preventDefault(),e.confirm(t)}}}),s("glovo-btn",{staticClass:"warning__buttons--cancel",attrs:{type:"green",text:this.$t("store.close.warn.cancel"),bold:!0,size:"large","data-qa":"cancel-button"},on:{clack:function(t){return t.stopPropagation(),t.preventDefault(),e.cancel(t)}}})],1)])],2)},p=[],f=(s("d81d"),s("a026")),m=s("2fe1"),v=s("1b40"),O=s("cd5f"),C=s("2505"),b=s("f257"),_=s("40c5");(function(e){e["stayOpen"]="STAY_OPEN",e["closeAnyway"]="CLOSE_ANYWAY"})(n||(n={}));var y=s("0e67"),S=s("314e"),A=s("73f7"),k=function(e){Object(c["a"])(s,e);var t=Object(d["a"])(s);function s(){return Object(a["a"])(this,s),t.apply(this,arguments)}return Object(l["a"])(s,[{key:"confirm",value:function(){this.$analytics.onStoreClosureWarningPressed(this.pendingOrdersIds,this.closedStoreIds,this.storeAdmin.id,n.closeAnyway),this.$emit("force-close")}},{key:"cancel",value:function(){this.$analytics.onStoreClosureWarningPressed(this.pendingOrdersIds,this.closedStoreIds,this.storeAdmin.id,n.stayOpen),this.$emit("cancel")}},{key:"dismiss",value:function(){this.$emit("dismiss")}},{key:"amountOfPendingOrders",get:function(){return this.pendingOrders.length}},{key:"pendingOrdersIds",get:function(){var e;return null===(e=this.pendingOrders)||void 0===e?void 0:e.map((function(e){return e.id}))}},{key:"pendingOrdersText",get:function(){return this.$tc("store.close.warn.pending",this.amountOfPendingOrders,{amount:this.amountOfPendingOrders})}},{key:"orderCancellationText",get:function(){return this.$tc("store.close.warn.cancelled",this.amountOfPendingOrders)}}]),s}(f["default"]);Object(u["c"])([Object(v["c"])({default:!1})],k.prototype,"open",void 0),Object(u["c"])([Object(v["c"])()],k.prototype,"closedStoreIds",void 0),Object(u["c"])([O["a"].Getter(b["l"])],k.prototype,"pendingOrders",void 0),Object(u["c"])([C["a"].Getter(_["d"])],k.prototype,"storeAdmin",void 0),k=Object(u["c"])([Object(m["b"])({name:"StoreClosingWarningModal",components:{GlovoModal:y["a"],GlovoBtn:S["a"],Icon:A["a"]}})],k);var w,R,U=k,M=U,I=(s("b219"),s("2877")),F=Object(I["a"])(M,g,p,!1,null,null,null),j=F.exports,x=s("ea9b"),D=s("7f45"),T=s.n(D),E=s("da28"),W=s.n(E),$=(s("4418"),s("5645")),N={wrapper:{"background-color":"none",border:"none"}},P={highlight:{backgroundColor:"#FFC244",color:"#ff"}},q={highlight:{backgroundColor:"none",borderColor:"#FFC244",borderWidth:"2px"}};(function(e){e["PEAK_TIME"]="PEAK_TIME",e["TECHNICAL_ISSUES"]="TECHNICAL_ISSUES",e["GLOVO_DEVICE"]="GLOVO_DEVICE",e["HOLIDAY"]="HOLIDAY",e["OTHER"]="OTHER"})(w||(w={})),function(e){e["CUSTOM"]="custom",e["THIRTY_MINUTES"]="THIRTY_MINUTES",e["ONE_HOUR"]="ONE_HOUR",e["END_OF_WORKING_DAY"]="END_OF_WORKING_DAY"}(R||(R={}));var H=s("93af"),L=s("be23"),Y=s("53e2"),G=s("e1e3"),V=s("4bb5"),B=s("1998"),z=function(){return s.e("chunk-ecd5fc06").then(s.bind(null,"432a"))},K=function(e){Object(c["a"])(s,e);var t=Object(d["a"])(s);function s(){var e;return Object(a["a"])(this,s),e=t.apply(this,arguments),e.dragAttributes=q,e.themeStyles=N,e.selectedAttributes=P,e.closedUntil=null,e.closedUntilCustom={start:"",end:""},e.closingTimeOptions=null,e.closingReasons=null,e.calendarInterval=null,e.loading=!1,e.closingReason=null,e.isLoadingClosedStores=!1,e.selectedAddressesForOpening=[],e.selectedAddressesForClosing=[],e.closedAddresses=[],e.shouldShowWarningModal=!1,e.hasWarnedUser=!1,e}return Object(l["a"])(s,[{key:"onClosedUntilCustomChange",value:function(){this.closedUntilCustom&&(this.closedUntil=R.CUSTOM)}},{key:"mounted",value:function(){this.retrieveClosedStoreAddresses(),this.retrieveClosingReasons()}},{key:"displayCustomOption",value:function(e){return this.closedUntil===R.CUSTOM&&e===R.CUSTOM}},{key:"retrieveClosedStoreAddresses",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.isLoadingClosedStores=!0,e.prev=1,t=Object(x["a"])($["HttpModule"].fetchService),s=t.getClosedStoreAddressIds,e.next=5,s(this.selectedStoreAddresses);case 5:n=e.sent,o=n.closedStoreAddressIds,this.closedAddresses=o,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),this.closedAddresses=[];case 13:return e.prev=13,this.isLoadingClosedStores=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"retrieveClosingReasons",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(x["a"])($["HttpModule"].fetchService),s=t.getTemporaryClosingOptions,e.next=4,s();case 4:n=e.sent,this.closingTimeOptions=n.untilOptions,this.closingTimeOptions.push({value:R.CUSTOM,displayText:this.$i18n.t("time.options.custom").toString()}),this.closingReasons=n.reasonOptions,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.error("getTemporaryClosingOptions failure: ".concat(e.t0));case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateStart",value:function(e){e&&e.start&&(this.closedUntilCustom.start=e.start)}},{key:"updateEnd",value:function(e){this.updateStart(e),e.end&&(this.closedUntilCustom.end=e.end)}},{key:"updateSelectedIdsForClosing",value:function(e){this.selectedAddressesForOpening=[],this.selectedAddressesForClosing=e}},{key:"updateSelectedIdsForOpening",value:function(e){this.selectedAddressesForClosing=[],this.closingReason=null,this.closedUntil=null,this.calendarInterval=null,this.selectedAddressesForOpening=e}},{key:"acceptFormChanges",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,!this.shouldWarnUserBeforeAccepting){e.next=4;break}return this.warnUserBeforeAccepting(),e.abrupt("return");case 4:if(!this.isOpeningOneOrMoreStores){e.next=9;break}return e.next=7,this.openStores();case 7:e.next=17;break;case 9:if(!this.isClosingOneOrMoreStoresWithoutDateRange){e.next=14;break}return e.next=12,this.closeStoresWithoutDateRange();case 12:e.next=17;break;case 14:if(!this.isCustomDateRange){e.next=17;break}return e.next=17,this.closeStoresWithDateRange();case 17:this.loading=!1,this.closeStoreClosingModal();case 19:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"openStores",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.selectedStoreAddressIdsForRequests(this.selectedAddressesForOpening),!this.checkinPending){e.next=4;break}return e.next=4,this.confirmCheckIn(t[0]);case 4:return e.next=6,this.openStoreAddressesNew(t);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"closeStoresWithoutDateRange",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.selectedStoreAddressIdsForRequests(this.selectedAddressesForClosing),e.next=3,this.closeStoreAddressesTemporarily({until:this.closedUntil,reason:this.closingReason,storeAddressIds:t});case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"closeStoresWithDateRange",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.selectedStoreAddressIdsForRequests(this.selectedAddressesForClosing),e.next=3,this.setClosingDays({interval:{start:this.formatDate(this.closedUntilCustom.start),end:this.formatDate(this.closedUntilCustom.end),reason:this.closingReason},storeAddressIds:t});case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"selectedStoreAddressIdsForRequests",value:function(e){return this.isMultiView?e:this.availableStoreAddresses}},{key:"warnUserBeforeAccepting",value:function(){this.shouldShowWarningModal=!0}},{key:"handleForceCloseFromModal",value:function(){this.shouldShowWarningModal=!1,this.hasWarnedUser=!0,this.acceptFormChanges()}},{key:"handleCancelFromModal",value:function(){this.shouldShowWarningModal=!1,this.closeStoreClosingModal(),this.$router.push(B["a"])}},{key:"handleDismissFromModal",value:function(){this.loading=!1,this.shouldShowWarningModal=!1}},{key:"closeStoreClosingModal",value:function(){this.$emit("close")}},{key:"formatDate",value:function(e){return T()(e).local().format("YYYY-MM-DD")}},{key:"shouldShowStoreOpeningSelector",get:function(){return this.isMultiView&&this.closedAddresses.length>0}},{key:"isClosed",get:function(){return!this.isOpen||this.closedAddresses.length>0}},{key:"hasAddressesSelectedForOpening",get:function(){return this.closedAddresses.length>0&&this.selectedAddressesForOpening.length>0}},{key:"noAddressesAreSelected",get:function(){return 0===this.selectedAddressesForOpening.length&&0===this.selectedAddressesForClosing.length}},{key:"isAcceptDisabled",get:function(){return!this.hasAddressesSelectedForOpening&&(!(!this.isMultiView||!this.noAddressesAreSelected)||(this.isOpen&&!this.isCustomDateRange?this.isMissingClosedUntilOrReason:!(!this.isOpen&&!this.closedUntil)&&(!(!this.isCustomDateRange||!this.hasNotSelectedDateRange)||this.isMissingClosedUntilOrReason)))}},{key:"isMissingClosedUntilOrReason",get:function(){return!this.closedUntil||!this.closingReason}},{key:"hasNotSelectedDateRange",get:function(){return!this.closedUntilCustom.start||!this.closedUntilCustom.end}},{key:"isCustomDateRange",get:function(){return this.closedUntil===R.CUSTOM}},{key:"filteredClosingReasons",get:function(){return this.closingReasons?this.isCustomDateRange?this.closingReasons.filter((function(e){return["HOLIDAY","OTHER"].includes(e.value)})):this.closingReasons.filter((function(e){return"HOLIDAY"!==e.value})):[]}},{key:"isOpeningOneOrMoreStores",get:function(){return!this.closedUntil&&(!this.isOpen||this.selectedAddressesForOpening.length>0)}},{key:"isClosingOneOrMoreStoresWithoutDateRange",get:function(){return!(!this.closedUntil||!this.closingReason||this.isCustomDateRange)}},{key:"checkinPending",get:function(){return this.isPendingCheckIn&&!this.isMultiView&&this.toggles.FE_PARTNERS_WEB_CHECK_IN_ENABLED}},{key:"shouldWarnUserBeforeAccepting",get:function(){return!(this.hasWarnedUser||!this.hasPendingOrders)&&(!!this.isClosingOneOrMoreStoresWithoutDateRange||!(!this.isCustomDateRange||!this.isTodaySelected))}},{key:"isTodaySelected",get:function(){return this.formatDate(this.closedUntilCustom.start)===this.formatDate(this.today)}},{key:"today",get:function(){return new Date}}]),s}(f["default"]);Object(u["c"])([Object(V["b"])(G["b"])],K.prototype,"toggles",void 0),Object(u["c"])([L["h"].Getter(L["d"])],K.prototype,"isOpen",void 0),Object(u["c"])([O["a"].Getter(b["n"])],K.prototype,"hasPendingOrders",void 0),Object(u["c"])([C["a"].Getter(_["c"])],K.prototype,"availableStoreAddresses",void 0),Object(u["c"])([C["a"].Getter(H["k"])],K.prototype,"isMultiView",void 0),Object(u["c"])([C["a"].Getter(_["f"])],K.prototype,"selectedStoreAddresses",void 0),Object(u["c"])([L["h"].Getter(L["c"])],K.prototype,"isPendingCheckIn",void 0),Object(u["c"])([L["h"].Action(Y["o"])],K.prototype,"openStoreAddresses",void 0),Object(u["c"])([L["h"].Action(Y["q"])],K.prototype,"openStoreAddressesNew",void 0),Object(u["c"])([L["h"].Action(Y["b"])],K.prototype,"closeStoreAddressesTemporarily",void 0),Object(u["c"])([L["h"].Action(Y["u"])],K.prototype,"setClosingDays",void 0),Object(u["c"])([L["h"].Action(Y["e"])],K.prototype,"confirmCheckIn",void 0),Object(u["c"])([Object(v["d"])("closedUntilCustom")],K.prototype,"onClosedUntilCustomChange",null),K=Object(u["c"])([Object(m["b"])({name:"StoreClosing",components:{StoreAddressSelector:z,StoreClosingWarningModal:j,ModalWrapper:h["a"],VCalendar:W.a}})],K);var J=K,Q=J,X=(s("c19a"),Object(I["a"])(Q,o,i,!1,null,"7d535c44",null));t["default"]=X.exports},a5be:function(e,t,s){},b219:function(e,t,s){"use strict";s("1f3a")},c19a:function(e,t,s){"use strict";s("a5be")}}]);